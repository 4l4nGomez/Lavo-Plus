---
import '../styles/global.css';
import Navbar from '../components/Navbar.astro';

interface Servicio {
  nombre: string;
  descripcion?: string;
  precio?: string;
  items?: string[];
}

interface ServiceType {
  icon: string;
  color: string;
}

// Usar fetch con URL completa y validación
let servicios: Servicio[] = [];
try {
  const response = await fetch(new URL('/config.json', Astro.url.origin));
  if (response.ok) {
    const data = await response.json();
    servicios = data.servicios || [];
  }
} catch (error) {
  console.error('Error loading config:', error);
  // Datos de respaldo
  servicios = [
    {
      nombre: "Lavado General",
      descripcion: "Servicio de lavado de ropa con cuidado especial para diferentes tipos de telas."
    },
    {
      nombre: "Lavado Exprés",
      descripcion: "Lavado rápido para prendas que necesitas listas en poco tiempo."
    }
  ];
}

const serviceTypes: Record<string, ServiceType> = {
  "Lavado General": { icon: "fa-soap", color: "blue" },
  "Lavado Exprés": { icon: "fa-bolt", color: "green" },
  "Tintorería": { icon: "fa-tshirt", color: "red" },
  "Servicios Adicionales": { icon: "fa-hand-holding-heart", color: "purple" }
};
---

<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <title>Servicios | Lavo Plus</title>
    <meta
      name="description"
      content="Lavandería y Tintorería en Puebla. Lavado, secado, planchado, y más con entrega a domicilio. ¡Cotiza por WhatsApp!"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="https://unpkg.com/aos@2.3.4/dist/aos.css" />
    <script src="https://unpkg.com/aos@2.3.4/dist/aos.js" defer></script>
  </head>
  <body class="bg-white text-gray-800 font-poppins">
    <Navbar />

    <main class="max-w-5xl mx-auto px-6 py-16">
      <h1
        class="text-4xl md:text-5xl font-extrabold text-center text-blue-800 mb-6 tracking-wide"
        data-aos="fade-down"
      >
        Servicios de Lavandería y Tintorería en Puebla
      </h1>
      <p
        class="text-center text-xl text-gray-600 mb-12 max-w-3xl mx-auto"
        data-aos="fade-up"
        data-aos-delay="100"
      >
        En <strong class="text-blue-700">Lavo Plus</strong> cuidamos tu ropa como
        si fuera nuestra. ¡Rápido, profesional y confiable!
      </p>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
        {servicios.map((servicio: Servicio, index: number) => {
          const serviceType = serviceTypes[servicio.nombre] || { 
            icon: "fa-star", 
            color: "indigo" 
          };
          const colorClasses = {
            bg: `bg-${serviceType.color}-600`,
            text: `text-${serviceType.color}-800`
          };
          
          return (
            <div
              class="bg-blue-50 rounded-2xl shadow-xl p-10 flex flex-col items-center text-center hover:shadow-2xl transition-shadow duration-300"
              data-aos="fade-up"
              data-aos-delay={200 + (index * 100)}
            >
              <div
                class={`${colorClasses.bg} text-white rounded-full p-6 mb-6 flex items-center justify-center`}
                style="width: 80px; height: 80px;"
              >
                <i class={`fas ${serviceType.icon} text-4xl`}></i>
              </div>
              <h3 class={`font-extrabold text-2xl ${colorClasses.text} mb-3`}>
                {servicio.nombre}
              </h3>
              
              {servicio.items ? (
                <ul class="text-gray-700 text-lg list-disc list-inside space-y-1">
                  {servicio.items.map((item: string) => (
                    <li>{item}</li>
                  ))}
                </ul>
              ) : (
                <p class="text-gray-700 text-lg">
                  {servicio.descripcion}
                </p>
              )}
              
              {servicio.precio && (
                <p class="mt-4 font-bold text-lg">
                  {servicio.precio}
                </p>
              )}
            </div>
          );
        })}
      </div>

      <!-- Botón de WhatsApp -->
      <div class="mt-16 text-center" data-aos="zoom-in" data-aos-delay={200 + (servicios.length * 100)}>
        <a
          href="https://wa.me/522225547693"
          target="_blank"
          class="inline-flex items-center gap-3 bg-green-500 hover:bg-green-600 text-white text-xl font-semibold py-4 px-10 rounded-full shadow-2xl transition duration-300"
        >
          <i class="fab fa-whatsapp text-2xl"></i>
          <span>¡Cotiza tu servicio por WhatsApp!</span>
        </a>
      </div>
    </main>

    <script>
      window.AOS.init({
        duration: 800,
        easing: 'ease-in-out',
        once: true,
      });
    </script>
  </body>
</html>